function ownKeys(c,d){var a=Object.keys(c);if(Object.getOwnPropertySymbols){var b=Object.getOwnPropertySymbols(c);d&&(b=b.filter(function(a){return Object.getOwnPropertyDescriptor(c,a).enumerable})),a.push.apply(a,b)}return a}function _objectSpread(c){for(var a=1;a<arguments.length;a++){var b=null!=arguments[a]?arguments[a]:{};a%2?ownKeys(Object(b),!0).forEach(function(a){_defineProperty(c,a,b[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(c,Object.getOwnPropertyDescriptors(b)):ownKeys(Object(b)).forEach(function(a){Object.defineProperty(c,a,Object.getOwnPropertyDescriptor(b,a))})}return c}function _defineProperty(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function _defineProperties(d,c){for(var b=0;b<c.length;b++){var a=c[b];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(d,a.key,a)}}function _createClass(a,b,c){return b&&_defineProperties(a.prototype,b),c&&_defineProperties(a,c),Object.defineProperty(a,"prototype",{writable:!1}),a}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var API_URL="https://62dc2d424438813a2612aa65.mockapi.io/api/todos",Todo=function(){"use strict";function a(b){var c=b.id,d=b.name,e=b.creationDate,f=b.node;_classCallCheck(this,a),this.id=c,this.name=d,this.creationDate=e,this.node=f}return _createClass(a)}(),TodoInput=function(){"use strict";function a(b,c){var d=b.todoController,e=b.todoApiService,f=b.todoHandler;_classCallCheck(this,a),this._todoController=d,this._todoApiService=e,this._todoHandler=f,this._setListeners(c)}return _createClass(a,[{key:"_setListeners",value:function(a){var b=this;a.addEventListener("submit",function(c){c.preventDefault(),c.stopPropagation();var d=new FormData(c.target).get("add-todo-input");if(!d)return null;var e={name:d,creationDate:new Date,status:!1};b._todoApiService.create(e).then(function(c){var d=b._todoController.create(c);b._todoHandler.addListeners(d),a.reset()})})}}]),a}(),TodoCreator=function(){"use strict";function a(){_classCallCheck(this,a)}return _createClass(a,[{key:"_createLi",value:function(b){var a=document.createElement("li");return a.className="rounded py-2 px-4"+(b?" done":""),a}},{key:"_createLoader",value:function(){var a=document.createElement("div"),b=document.createElement("span");return a.className="spinner-border text-primary hidden",a.setAttribute("role","status"),b.className="visually-hidden",b.innerText="Loading...",a.append(b),a}},{key:"_createLabel",value:function(c,b){var a=document.createElement("label");return a.className="name",a.setAttribute("for","status-".concat(c)),a.setAttribute("title",b),a.innerText=b,a}},{key:"_createControlsContainer",value:function(){var a=document.createElement("div");return a.className="controls",a}},{key:"_createDeleteBtn",value:function(){var a=document.createElement("button");return a.className="btn btn-sm btn-danger me-3",a.innerText="Delete",a}},{key:"_createStatusCheckbox",value:function(b,c){var a=document.createElement("input");return a.className="form-check-input",a.setAttribute("id","status-".concat(b)),a.setAttribute("name","status-".concat(b)),a.setAttribute("type","checkbox"),a.checked=c,a}},{key:"createTodo",value:function(a){var b=a.id,f=a.name,c=(a.creationDate,a.status),d=this._createLi(c),g=this._createLabel(b,f),e=this._createControlsContainer(),h=this._createDeleteBtn(),i=this._createStatusCheckbox(b,c),j=this._createLoader();return e.append(h,i),d.append(g,e,j),d}}]),a}(),TodoController=function(){"use strict";function a(b,c){var d=b.todoCreator;_classCallCheck(this,a),this._todoList=c,this._todoCreator=d,this.allTodos={}}return _createClass(a,[{key:"startLoading",value:function(a){this.takeById(a).node.querySelector(".spinner-border").classList.remove("hidden")}},{key:"endLoading",value:function(a){this.takeById(a).node.querySelector(".spinner-border").classList.add("hidden")}},{key:"remove",value:function(a){try{this.allTodos[a].node.remove(),delete this.allTodos[a]}catch(b){console.error("Todo with such id not found: ".concat(b))}}},{key:"update",value:function(a){try{var b=this.takeById(a.id);b.status=a.status,a.status?b.node.classList.add("done"):b.node.classList.remove("done")}catch(c){console.error("Todo with such id not found: ".concat(c))}}},{key:"takeById",value:function(a){return this.allTodos[a]}},{key:"create",value:function(a){var b=this._todoCreator.createTodo(a),c=new Todo(_objectSpread(_objectSpread({},a),{},{node:b}));return this._todoList.append(b),this.allTodos[a.id]=c,c}}]),a}(),TodoApiService=function(){"use strict";function a(b){_classCallCheck(this,a),this._API_URL=b,this.headers={Accept:"application/json","Content-Type":"application/json"}}return _createClass(a,[{key:"delete",value:function(a){return fetch("".concat(this._API_URL,"/").concat(a),{method:"DELETE",headers:this.headers}).catch(function(a){return console.error(a)})}},{key:"create",value:function(a){return fetch("".concat(this._API_URL),{method:"POST",headers:this.headers,body:JSON.stringify(a)}).catch(function(a){return console.error(a)}).then(function(a){return a.json()})}},{key:"update",value:function(a){return fetch("".concat(this._API_URL,"/").concat(a.id),{method:"PUT",headers:this.headers,body:JSON.stringify(a)}).catch(function(a){return console.error(a)}).then(function(a){return a.json()})}},{key:"getAll",value:function(){return fetch(this._API_URL,{headers:this.headers}).catch(function(a){return console.error(a)}).then(function(a){return a.json()})}}]),a}(),TodoHandler=function(){"use strict";function a(b){var c=b.todoController,d=b.todoApiService;_classCallCheck(this,a),this._todoController=c,this._todoApiService=d}return _createClass(a,[{key:"addListeners",value:function(a){var d=this,b=a.node.querySelector(".btn-danger"),c=a.node.querySelector(".form-check-input");b.addEventListener("click",function(){d._delete(a.id)}),c.addEventListener("input",function(b){d._update(_objectSpread(_objectSpread({},a),{},{status:b.target.checked}))})}},{key:"_delete",value:function(a){var b=this;this._todoController.startLoading(a),this._todoApiService.delete(a).then(function(){b._todoController.remove(a),b._todoController.endLoading(a)})}},{key:"_update",value:function(a){var b=this;this._todoController.startLoading(a.id),this._todoApiService.update(a).then(function(a){b._todoController.update(a),b._todoController.endLoading(a.id)})}}]),a}();window.addEventListener("load",function(){var b=document.getElementById("todo-container"),d=b.querySelector("#todo-list"),g=b.querySelector(".main-loading"),e=new TodoCreator,c=new TodoController({todoCreator:e},d),a=new TodoApiService(API_URL),f=new TodoHandler({todoController:c,todoApiService:a});new TodoInput({todoController:c,todoApiService:a,todoHandler:f},document.querySelector("#add-todo-form")),a.getAll().then(function(a){a.forEach(function(a){var b=c.create(a);f.addListeners(b)}),g.style.display="none"})})
